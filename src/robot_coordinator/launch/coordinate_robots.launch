<launch>
    <!-- ======================= 인자(Argument) 정의 ======================= -->
    <!-- 두산 로봇 연결 정보 -->
    <arg name="model"  default="a0912" doc="Doosan Robot Model Name"/>
    <arg name="mode"   default="real"  doc="real/simulation"/>
    <arg name="host"   default="192.168.137.100" doc="Doosan Controller IP address"/>

    <!-- 모바일 로봇 연결 정보 -->
    <arg name="mobile_ip" default="169.254.128.2" doc="Mobile Robot IP address"/>

    <!-- ======================= 두산 로봇 관련 노드 ======================= -->

    <!-- 1. 두산 로봇 드라이버 및 MoveIt 실행 -->
    <!-- 중요: dsr_launcher 패키지의 dsr_moveit.launch 파일을 포함(include) -->
    <include file="$(find dsr_launcher)/launch/dsr_moveit.launch">
        <arg name="model" value="$(arg model)"/>
        <arg name="mode"  value="$(arg mode)"/>
        <arg name="host"  value="$(arg host)"/>
    </include>

    <!-- 2. 두산 로봇 액션 서버 실행 -->
    <node name="doosan_action_server" pkg="doosan_helper" type="doosan_action_server" output="screen"/>

    <!-- ======================= 모바일 로봇 관련 노드 ======================= -->

    <!-- 3. 모바일 로봇 액션 서버 실행 -->
    <!-- 참고: mobile_robot_action_server.py 파일 내에서 IP 주소를 사용하므로,
         여기서는 launch 파일의 인자를 직접 넘기지는 않음 (필요시 코드 수정 가능) -->
    <node name="mobile_robot_action_server" pkg="mobile_robot_control" type="mobile_robot_action_server.py" output="screen"/>

    <!-- ======================= 중앙 관제탑 노드 ======================= -->

    <!-- 4. 중앙 관제탑 노드 실행 -->
    <!-- respawn="true"는 노드가 예기치 않게 종료되면 자동으로 재시작하는 옵션 -->
    <node name="robot_coordinator" pkg="robot_coordinator" type="coordinator_node" output="screen" respawn="true" launch-prefix="bash -c 'sleep 5; $0 $@'"/>

</launch>